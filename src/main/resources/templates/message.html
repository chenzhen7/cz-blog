<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta name="referrer" content="no-referrer"/>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç•™è¨€æ¿-ChenZhençš„å®¢æ ˆ-CZçš„javaå­¦ä¹ æ—¥è®°</title>
    <meta name=â€Descriptionâ€ Content=â€ChenZhençš„ä¸ªäººåšå®¢ï¼Œç•™è¨€æ¿é¡µé¢ï¼Œåšå®¢ç•™è¨€ä¿¡æ¯æ˜¾ç¤ºâ€>
    <meta name=â€Keywordsâ€ Content=â€ChenZhen,åšå®¢,ç•™è¨€æ¿,ç•™è¨€â€³>
    <link href="../static/images/favicon.ico" th:href="@{/images/favicon.ico}" rel="icon" type="image/x-ico">
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}"  />
    <link rel="stylesheet" href="../static/css/me.css" th:href="@{/css/me.css}">
</head>
<body>

<!--å¯¼èˆª-->
<div  class="cz-navbar fixed">
    <div class="cz-pc-menu">
        <a href="index.html" th:href="@{/}" class="cz-navbar-brand text-decoration-none"><strong th:text="${author}">ChenZhen</strong></a>
        <div class="cz-navbar-links fs-6 fw-light" id="cz-navbar-links">
            <a href="index.html"    th:href="@{/}" class="cz-nav-link">é¦–é¡µ</a>
            <a href="tags.html"     th:href="@{/tags}" class="cz-nav-link ">æ ‡ç­¾</a>
            <a href="archives.html" th:href="@{/archives}" class="cz-nav-link ">å½’æ¡£</a>
            <a href="message.html"  th:href="@{/message}" class="cz-nav-link cz-active-link">ç•™è¨€æ¿</a>
            <a href="friends.html"  th:href="@{/friends}" class="cz-nav-link">å‹é“¾</a>
            <a href="about.html"    th:href="@{/about}" class="cz-nav-link">å…³äºæˆ‘</a>
        </div>
        <a href="#" class="cz-navbar-brand" data-bs-toggle="modal" data-bs-target="#searchModal">
            <strong>æœç´¢</strong>
        </a>


        <button class="cz-menu-toggle-btn">èœå•</button>
    </div>
    <div class="cz-mobile-menu fw-light fs-6">
        <a href="index.html"    th:href="@{/}" class="cz-nav-link">é¦–é¡µ</a>
        <a href="tags.html"     th:href="@{/tags}" class="cz-nav-link ">æ ‡ç­¾</a>
        <a href="archives.html" th:href="@{/archives}" class="cz-nav-link ">å½’æ¡£</a>
        <a href="message.html"  th:href="@{/message}" class="cz-nav-link cz-active-link">ç•™è¨€æ¿</a>
        <a href="friends.html"  th:href="@{/friends}" class="cz-nav-link">å‹é“¾</a>
        <a href="about.html"    th:href="@{/about}" class="cz-nav-link">å…³äºæˆ‘</a>
    </div>
</div>

<!-- æœç´¢æ¡† -->
<div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content p-2 ">
            <div class="modal-body ">
                <button type="button" class="btn-close float-end" data-bs-dismiss="modal" aria-label="Close"></button>
                <div class="text-center fs-5 mb-3">æœã€€ç´¢</div>
                <div class="input-group mb-4">
                    <span class="input-group-text" id="basic-addon1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                          <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                    </span>
                    <input id="keywordInput" type="text" class="form-control" placeholder="è¾“å…¥å…³é”®è¯" aria-describedby="basic-addon1">
                </div>

                <div class="mb-2">æœç´¢ç»“æœ</div>
                <!-- æœç´¢ç»“æœå±•ç¤ºåŒºåŸŸ -->
                <div id="searchResults" class="list-group">
                </div>
            </div>

        </div>
    </div>
</div>


<!--é¡¶éƒ¨èƒŒæ™¯å›¾ç‰‡-->
<div  alt="" class="cz-bg-section cz-bg-img"
      style="height: 45vh;background-image:url('../static/images/message.jpg')"
      th:style="'height: 45vh;background-image: url(' + @{/images/message.jpg} + ')'">

    <div class="m-bg-class_cover" align="center">
        <p class="cz-page-title"> ğŸ“ªç•™è¨€æ¿ </p>
        <p class="cz-page-title2 fw-normal">æœ‰ä»€ä¹ˆå¯¹æˆ‘æƒ³è¯´çš„è¯ï¼Œæ¥å§ï¼</p>
    </div>

</div>


<div class="container " style="margin-top: -4em;max-width: 1200px">
    <div class="col">
        <div class="card border-2 mb-3 shadow">
            <!--è¡¨å•-->
            <div id="message-form"  class="card-body border-1">
                <div class="row align-items-center mb-3">
                    <!--å¤´åƒ-->
                    <div class="col-auto">
                        <a class="avatar">
                            <img id="avatar" class="img-thumbnail w-100 h-100" >
                        </a>
                    </div>
                    <!--è¾“å…¥-->
                    <div class="col">
                        <div class="row">
                            <input type="hidden" name="parentMessageId" >
                            <input type="hidden" name="rootMessageId">
                            <input type="hidden" name="avatar">

                            <div class="col-md-4 mb-1">
                                <input name="email" type="email" class="form-control" placeholder="é‚®ç®±" id="emailInput" oninput="checkQQEmail()" th:value="${session.user != null ? session.user.email : ''}">
                            </div>
                            <div class="col-md-4 mb-1">
                                <input name="nickname" type="text" class="form-control" placeholder="æ˜µç§°" th:value="${session.user != null ? session.user.nickname : ''}">
                            </div>
                            <div class="col-md-4 mb-1">
                                <input name="address"  type="text" class="form-control" placeholder="ç«™ç‚¹">
                            </div>
                        </div>
                    </div>


                </div>
                <!--ç•™è¨€å†…å®¹-->
                <div class="row align-items-center mb-3">
                    <div class="col">
                        <textarea id="message-content" name="content" class="form-control" rows="3" placeholder="æ³¨æ„æ–‡æ˜å‘è¨€å“¦~"></textarea>
                    </div>
                </div>
                <!--è¡¨æƒ…æ¡†-->
                <div class="cz-emoji-container mb-3">
                    <div class="cz-emoji-content">
                        <!-- Emoji åˆ—è¡¨ -->
                        <span onclick="addEmoji('ğŸ˜€')">ğŸ˜€</span><span onclick="addEmoji('ğŸ˜ƒ')">ğŸ˜ƒ</span><span onclick="addEmoji('ğŸ˜„')">ğŸ˜„</span><span onclick="addEmoji('ğŸ˜')">ğŸ˜</span><span onclick="addEmoji('ğŸ˜†')">ğŸ˜†</span><span onclick="addEmoji('ğŸ˜…')">ğŸ˜…</span><span onclick="addEmoji('ğŸ¤£')">ğŸ¤£</span><span onclick="addEmoji('ğŸ˜‚')">ğŸ˜‚</span><span onclick="addEmoji('ğŸ™‚')">ğŸ™‚</span><span onclick="addEmoji('ğŸ™ƒ')">ğŸ™ƒ</span><span onclick="addEmoji('ğŸ˜‰')">ğŸ˜‰</span><span onclick="addEmoji('ğŸ˜Š')">ğŸ˜Š</span><span onclick="addEmoji('ğŸ˜‡')">ğŸ˜‡</span><span onclick="addEmoji('ğŸ¥°')">ğŸ¥°</span><span onclick="addEmoji('ğŸ˜')">ğŸ˜</span><span onclick="addEmoji('ğŸ¤©')">ğŸ¤©</span><span onclick="addEmoji('ğŸ˜˜')">ğŸ˜˜</span><span onclick="addEmoji('ğŸ˜—')">ğŸ˜—</span><span onclick="addEmoji('ğŸ˜š')">ğŸ˜š</span><span onclick="addEmoji('ğŸ˜™')">ğŸ˜™</span><span onclick="addEmoji('ğŸ˜‹')">ğŸ˜‹</span><span onclick="addEmoji('ğŸ˜›')">ğŸ˜›</span><span onclick="addEmoji('ğŸ˜œ')">ğŸ˜œ</span><span onclick="addEmoji('ğŸ¤ª')">ğŸ¤ª</span><span onclick="addEmoji('ğŸ˜')">ğŸ˜</span><span onclick="addEmoji('ğŸ¤‘')">ğŸ¤‘</span><span onclick="addEmoji('ğŸ¤—')">ğŸ¤—</span><span onclick="addEmoji('ğŸ¤­')">ğŸ¤­</span><span onclick="addEmoji('ğŸ¤«')">ğŸ¤«</span><span onclick="addEmoji('ğŸ¤”')">ğŸ¤”</span><span onclick="addEmoji('ğŸ¤')">ğŸ¤</span><span onclick="addEmoji('ğŸ¤¨')">ğŸ¤¨</span><span onclick="addEmoji('ğŸ˜')">ğŸ˜</span><span onclick="addEmoji('ğŸ˜‘')">ğŸ˜‘</span><span onclick="addEmoji('ğŸ˜¶')">ğŸ˜¶</span><span onclick="addEmoji('ğŸ˜')">ğŸ˜</span><span onclick="addEmoji('ğŸ˜’')">ğŸ˜’</span><span onclick="addEmoji('ğŸ™„')">ğŸ™„</span><span onclick="addEmoji('ğŸ˜¬')">ğŸ˜¬</span><span onclick="addEmoji('ğŸ¤¥')">ğŸ¤¥</span><span onclick="addEmoji('ğŸ˜Œ')">ğŸ˜Œ</span><span onclick="addEmoji('ğŸ˜”')">ğŸ˜”</span><span onclick="addEmoji('ğŸ˜ª')">ğŸ˜ª</span><span onclick="addEmoji('ğŸ¤¤')">ğŸ¤¤</span><span onclick="addEmoji('ğŸ˜´')">ğŸ˜´</span><span onclick="addEmoji('ğŸ˜·')">ğŸ˜·</span><span onclick="addEmoji('ğŸ¤’')">ğŸ¤’</span><span onclick="addEmoji('ğŸ¤•')">ğŸ¤•</span><span onclick="addEmoji('ğŸ¤¢')">ğŸ¤¢</span><span onclick="addEmoji('ğŸ¤®')">ğŸ¤®</span><span onclick="addEmoji('ğŸ¤§')">ğŸ¤§</span><span onclick="addEmoji('ğŸ¥µ')">ğŸ¥µ</span><span onclick="addEmoji('ğŸ¥¶')">ğŸ¥¶</span><span onclick="addEmoji('ğŸ¥´')">ğŸ¥´</span><span onclick="addEmoji('ğŸ˜µ')">ğŸ˜µ</span><span onclick="addEmoji('ğŸ¤¯')">ğŸ¤¯</span><span onclick="addEmoji('ğŸ¤ ')">ğŸ¤ </span><span onclick="addEmoji('ğŸ¥³')">ğŸ¥³</span><span onclick="addEmoji('ğŸ˜')">ğŸ˜</span><span onclick="addEmoji('ğŸ¤“')">ğŸ¤“</span><span onclick="addEmoji('ğŸ§')">ğŸ§</span><span onclick="addEmoji('ğŸ˜•')">ğŸ˜•</span><span onclick="addEmoji('ğŸ˜Ÿ')">ğŸ˜Ÿ</span><span onclick="addEmoji('ğŸ™')">ğŸ™</span><span onclick="addEmoji('â˜¹ï¸')">â˜¹ï¸</span><span onclick="addEmoji('ğŸ˜®')">ğŸ˜®</span><span onclick="addEmoji('ğŸ˜¯')">ğŸ˜¯</span><span onclick="addEmoji('ğŸ˜²')">ğŸ˜²</span><span onclick="addEmoji('ğŸ˜³')">ğŸ˜³</span><span onclick="addEmoji('ğŸ¥º')">ğŸ¥º</span><span onclick="addEmoji('ğŸ˜¦')">ğŸ˜¦</span><span onclick="addEmoji('ğŸ˜§')">ğŸ˜§</span><span onclick="addEmoji('ğŸ˜¨')">ğŸ˜¨</span><span onclick="addEmoji('ğŸ˜°')">ğŸ˜°</span><span onclick="addEmoji('ğŸ˜¥')">ğŸ˜¥</span><span onclick="addEmoji('ğŸ˜¢')">ğŸ˜¢</span><span onclick="addEmoji('ğŸ˜­')">ğŸ˜­</span><span onclick="addEmoji('ğŸ˜±')">ğŸ˜±</span><span onclick="addEmoji('ğŸ˜–')">ğŸ˜–</span><span onclick="addEmoji('ğŸ˜£')">ğŸ˜£</span><span onclick="addEmoji('ğŸ˜')">ğŸ˜</span><span onclick="addEmoji('ğŸ˜“')">ğŸ˜“</span><span onclick="addEmoji('ğŸ˜©')">ğŸ˜©</span><span onclick="addEmoji('ğŸ˜«')">ğŸ˜«</span><span onclick="addEmoji('ğŸ¥±')">ğŸ¥±</span><span onclick="addEmoji('ğŸ˜¤')">ğŸ˜¤</span><span onclick="addEmoji('ğŸ˜¡')">ğŸ˜¡</span><span onclick="addEmoji('ğŸ˜ ')">ğŸ˜ </span><span onclick="addEmoji('ğŸ¤¬')">ğŸ¤¬</span>
                    </div>
                </div>
                <!--å‘é€-->
                <div class="row align-items-center">
                    <div class="col">
                        <button id="messagepost-btn" type="button" class="btn btn-secondary w-100">å‘é€</button>
                    </div>
                </div>

            </div>
        </div>

        <div class="card border-2 mb-3 shadow">
            <div class="card-body border-1">
                <!--è¯„è®ºåˆ—è¡¨-->
                <div class="cz-comment-section" id="message-container" th:fragment="messageList">
                    <div class="cz-comment" th:each="message : ${page.list}">
                            <div class="avatar" >
                            <img class="img-thumbnail w-100 h-100" src="../static/images/me.jpg" th:src="@{${message.avatar}}">
                            <a href="#" target="_blank" th:href="@{${message.address}}" th:if="${message.address != null}">
                                <div class="img-thumbnail cz-avatar-overlay">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="white" class="bi bi-link-45deg" viewBox="0 0 16 16">
                                        <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/>
                                        <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/>
                                    </svg>
                                </div>
                            </a>
                        </div>
                        <div class="cz-comment-content" >
                            <div class="cz-user-info">
                                <span th:text="${message.nickname}">ChenZhen</span>
                                <span class="badge text-bg-secondary" th:if="${message.adminMessage}">ç«™ä¸»</span>
                            </div>
                            <div class="cz-comment-text" th:text="${message.content}" >å¿«æ¥è¯´ç‚¹ä»€ä¹ˆå§</div>
                            <div class="cz-comment-footer">
                                <span th:text="${#temporals.format(message.createTime)}">2023-12-15 23:46</span>
                                <!--<span>Like</span>-->
                                <a href="#" class="me-1"
                                   th:data-parentmessageid="${message.id}"
                                   th:data-messagenickname="${message.nickname}"
                                   th:data-rootmessageid="${message.id}"
                                   onclick="reply(this)" >
                                    å›å¤
                                </a>
                                <a href="#"
                                   th:if="${session.user}"
                                   th:href="@{/message/delete/{id}(id=${message.id},pageNum=${page.pageNum})}"
                                   onclick="return confirm('ç¡®å®šè¦åˆ é™¤è¯¥è¯„è®ºå—ï¼Ÿä¸‰æ€å•Š! åˆ äº†å¯å°±æ²¡äº†ï¼')">
                                    åˆ é™¤
                                </a>
                            </div>
                            <!--è¯„è®ºå›å¤åˆ—è¡¨-->
                            <div class="cz-reply-section" th:if="${#arrays.length(message.messageReplyList)} > 0">
                                <div class="cz-comment" th:each="reply : ${message.messageReplyList}">

                                    <div class="avatar" >
                                        <img class="img-thumbnail w-100 h-100" src="../static/images/me.jpg" th:src="@{${reply.avatar}}">
                                        <a href="#" target="_blank" th:href="@{${reply.address}}" th:if="${reply.address != null}">
                                            <div class="img-thumbnail cz-avatar-overlay">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="white" class="bi bi-link-45deg" viewBox="0 0 16 16">
                                                    <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/>
                                                    <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/>
                                                </svg>
                                            </div>
                                        </a>
                                    </div>
                                    <div class="cz-comment-content">
                                        <div class="cz-user-info">
                                            <span th:text="${reply.nickname}">ChenZhen</span>
                                            <span class="badge text-bg-secondary" th:if="${reply.adminMessage}">ç«™ä¸»</span>
                                            <span th:if="${reply.parentMessageId != reply.rootMessageId}" th:text="'@' + ${reply.parentNickname}" class="ps-2 text-primary">@å°ç™½</span>
                                        </div>
                                        <div class="cz-comment-text" th:text="${reply.content}">å¿«æ¥è¯´ç‚¹ä»€ä¹ˆå§</div>
                                        <div class="cz-comment-footer">
                                            <span th:text="${#temporals.format(reply.createTime)}">2023-12-15 23:46</span>
                                            <!--                                <span>Like</span>-->
                                            <a href="#" class="me-1"
                                               th:data-parentmessageid="${reply.id}"
                                               th:data-messagenickname="${reply.nickname}"
                                               th:data-rootmessageid="${message.id}"
                                               onclick="reply(this)" >
                                                å›å¤
                                            </a>
                                            <a href="#"
                                               th:if="${session.user}"
                                               th:href="@{/message/delete/{id}(id=${reply.id},pageNum=${page.pageNum})}"
                                               onclick="return confirm('ç¡®å®šè¦åˆ é™¤è¯¥è¯„è®ºå—ï¼Ÿä¸‰æ€å•Š! åˆ äº†å¯å°±æ²¡äº†ï¼')">
                                                åˆ é™¤
                                            </a>
                                        </div>
                                    </div>
                                </div>


                            </div>


                        </div>
                    </div>


                </div>

                <!--åˆ†é¡µ-->
                <nav>
                    <ul class="pagination justify-content-center">
                        <li class="page-item" th:classappend="${page.hasPreviousPage} ? 'page-item' : 'page-item disabled' ">
                            <a class="page-link text-black" href="#" th:href="@{ '/message?pageNum=' + ${page.prePage}}">ä¸Šä¸€é¡µ</a>
                        </li>

                        <li class="page-item"
                            th:each="num : ${page.navigatepageNums}"
                            th:classappend="${page.pageNum == num} ? 'page-item active' : 'page-item'">
                            <a class="page-link text-black fw-bold" href="#" th:href="@{ '/message?pageNum=' + ${num}}" th:text="${num}">1</a>
                        </li>

                        <li class="page-item" th:classappend="${page.hasNextPage} ? 'page-item' : 'page-item disabled' ">
                            <a class="page-link text-black" href="#" th:href="@{ '/message?pageNum=' + ${page.nextPage}}" >ä¸‹ä¸€é¡µ</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>

<!--åº•éƒ¨æ -->
<footer class="border-top p-3 bg-white text-muted small">
    <div class="container pb-5 ">
        <div class=" d-flex align-items-center justify-content-between">
            <div>
                <span class="cz-navbar-brand mr-2"><strong th:text="${author}">ChenZhen</strong></span>æˆ‘çš„åšå®¢å·²è¥ä¸šï¼š<span id="htmer_time">1å¹´105å¤©8æ—¶13åˆ†28ç§’</span>
            </div>
            <div>
                <a target="_blank" class="text-secondary fw-bold" href="#">ç²¤ICPå¤‡2022122083å·-1</a>
            </div>
        </div>
    </div>
</footer>



<script src="../static/lib/bootstrap.bundle.min.js" th:src="@{/lib/bootstrap.bundle.min.js}"></script>
<script src="../static/lib/jquery-3.2.1/jquery-3.2.1.min.js" th:src="@{/lib/jquery-3.2.1/jquery-3.2.1.min.js}"></script>
<script src="../static/lib/clickEffect.js" th:src="@{/lib/clickEffect.js}"></script>



<script th:inline="javascript">



    // ç§»åŠ¨è®¾å¤‡å¯¼èˆªæ æ ·å¼åˆ‡æ¢
    // è·å–èœå•åˆ‡æ¢æŒ‰é’®å’Œç§»åŠ¨è®¾å¤‡èœå•åˆ—è¡¨çš„å¼•ç”¨
    const menuToggleBtn = document.querySelector('.cz-menu-toggle-btn');
    const mobileMenu = document.querySelector('.cz-mobile-menu');
    // ç‚¹å‡»èœå•åˆ‡æ¢æŒ‰é’®æ—¶çš„äº‹ä»¶å¤„ç†å‡½æ•°
    menuToggleBtn.addEventListener('click', () => {
        // åˆ‡æ¢ç§»åŠ¨è®¾å¤‡èœå•åˆ—è¡¨çš„æ˜¾ç¤ºçŠ¶æ€
        mobileMenu.classList.toggle('show');
    });

    function addEmoji(emoji) {
        var contentTextarea = document.getElementById('message-content');
        contentTextarea.value = contentTextarea.value + emoji;
    }

    function checkQQEmail() {
        var emailInput = document.getElementById('emailInput');
        var avatar = document.getElementById('avatar');

        // æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…QQé‚®ç®±
        var qqEmailRegex = /^[1-9]\d{4,10}@qq\.com$/;
        var userEmail = emailInput.value.trim();

        if (qqEmailRegex.test(userEmail)) {
            // æå–QQå·ç 
            var qqNumber = userEmail.split('@')[0];
            // æ„å»ºQQå¤´åƒURL
            var avatarURL = 'http://q1.qlogo.cn/g?b=qq&nk=' + qqNumber + '&s=100';
            // æ›´æ–°å¤´åƒ
            avatar.src = avatarURL;
            $("[name='avatar']").val(avatarURL);
        } else {
            // å¦‚æœä¸æ˜¯QQé‚®ç®±ï¼Œæ˜¾ç¤ºé»˜è®¤å›¾ç‰‡
            avatar.src = '/images/me.jpg';
            $("[name='avatar']").val('/images/me.jpg');

        }
    }


    // è¿è¡Œæ—¶é—´ç»Ÿè®¡
    function secondToDate(second) {
        if (!second) {
            return 0;
        }
        var time = new Array(0, 0, 0, 0, 0);
        if (second >= 365 * 24 * 3600) {
            time[0] = parseInt(second / (365 * 24 * 3600));
            second %= 365 * 24 * 3600;
        }
        if (second >= 24 * 3600) {
            time[1] = parseInt(second / (24 * 3600));
            second %= 24 * 3600;
        }
        if (second >= 3600) {
            time[2] = parseInt(second / 3600);
            second %= 3600;
        }
        if (second >= 60) {
            time[3] = parseInt(second / 60);
            second %= 60;
        }
        if (second > 0) {
            time[4] = second;
        }
        return time;
    }
    function setTime() {
        /*æ­¤å¤„ä¸ºç½‘ç«™çš„åˆ›å»ºæ—¶é—´*/
        var create_time = Math.round(new Date(Date.UTC(2022, 8, 21, 15, 15, 15)).getTime() / 1000);
        var timestamp = Math.round((new Date().getTime() + 8 * 60 * 60 * 1000) / 1000);
        currentTime = secondToDate((timestamp - create_time));
        currentTimeHtml = currentTime[0] + 'å¹´' + currentTime[1] + 'å¤©'
            + currentTime[2] + 'æ—¶' + currentTime[3] + 'åˆ†' + currentTime[4]
            + 'ç§’';
        document.getElementById("htmer_time").innerHTML = currentTimeHtml;
    }
    setInterval(setTime, 1000);


    // ç‚¹å‡»å‘é€æŒ‰é’®æ—¶è§¦å‘æ ¡éªŒé€»è¾‘
    $('#messagepost-btn').click(function() {
        // è·å–è¾“å…¥çš„å€¼
        var email = $('input[name="email"]').val();
        var nickname = $('input[name="nickname"]').val();
        var content = $('textarea[name="content"]').val();

        // æ ¡éªŒé‚®ç®±
        if (!isValidEmail(email)) {
            alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€');
            return ;
        }
        // æ ¡éªŒæ˜µç§°
        if (!nickname.trim()) {
            alert('æ˜µç§°ä¸èƒ½ä¸ºç©º');
            return ;
        }

        // æ ¡éªŒç•™è¨€å†…å®¹
        if (!content.trim()) {
            alert('ç•™è¨€å†…å®¹ä¸èƒ½ä¸ºç©º');
            return ;
        }
        postData();
    });


    // ç®€å•çš„é‚®ç®±æ ¼å¼æ ¡éªŒå‡½æ•°
    function isValidEmail(email) {
        var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }


    //å‘é€è¯·æ±‚ç»™åç«¯
    function postData() {
        // ä»åœ°å€æ è§£æå‚æ•°
        var urlParams = new URLSearchParams(window.location.search);
        var pageNumParam = urlParams.get('pageNum');
        var pageNum = pageNumParam ? parseInt(pageNumParam) : 1;
        $("#message-container").load(`/message?pageNum=${pageNum}`,{
            "parentMessageId" : $("[name='parentMessageId']").val(),
            "rootMessageId" : $("[name='rootMessageId']").val(),
            "nickname": $("[name='nickname']").val(),
            "email"   : $("[name='email']").val(),
            "avatar" : $("[name='avatar']").val(),
            "content" : $("[name='content']").val(),
            "address" : $("[name='address']").val()

        },function (responseTxt, statusTxt, xhr) {
            clearContent();
        });

    }

    // æ¸…é™¤è¡¨å•
    function clearContent() {
        $("[name='content']").val('');
        $("[name='parentMessageId']").val(null);
        $("[name='rootMessageId']").val(null);
        $("[name='content']").attr("placeholder", "è¯·è¾“å…¥è¯„è®ºä¿¡æ¯...");
    }

    function reply(obj) {
        var rootMessageId = $(obj).data('rootmessageid');
        var parentmessageId = $(obj).data('parentmessageid');
        var messageNickname = $(obj).data('messagenickname');

        $("[name='content']").attr("placeholder", "@" + messageNickname + ":").focus();
        $("[name='parentMessageId']").val(parentmessageId);
        $("[name='rootMessageId']").val(rootMessageId);
        $(window).scrollTo(0,500);
    }

    // è·å–å…³é”®è¯è¾“å…¥æ¡†
    const keywordInput = $('#keywordInput');
    //æœç´¢ å½“ç”¨æˆ·è¾“å…¥ç»“æŸæ—¶è§¦å‘äº‹ä»¶
    keywordInput.on('input', function() {
        // ä½¿ç”¨å®šæ—¶å™¨å»¶è¿Ÿå‘é€ AJAX è¯·æ±‚ï¼Œä»¥ç¡®ä¿ç”¨æˆ·è¾“å…¥ç»“æŸ
        clearTimeout(this.timer);
        this.timer = setTimeout(function () {
            // è·å–ç”¨æˆ·è¾“å…¥çš„å…³é”®è¯
            const keyword = keywordInput.val();
            // å‘é€ AJAX è¯·æ±‚
            $.ajax({
                url: '/search',
                method: 'GET',
                data: { keyword: keyword },
                success: function(response) {
                    // å¤„ç†ä»åç«¯è¿”å›çš„æ•°æ®
                    if (response.code === 20000){
                        var resultList = response.data.blogs;
                        // è·å–æœç´¢ç»“æœåˆ—è¡¨å®¹å™¨
                        var searchResults = $('#searchResults');
                        // æ¸…ç©ºåŸæ¥çš„ç»“æœ
                        searchResults.empty();
                        if (resultList){
                            // æ¸²æŸ“æœç´¢ç»“æœåˆ—è¡¨
                            resultList.forEach(function(blog) {
                                var blogItem = $('<a>').attr('href', `/blog/${blog.id}`).addClass('list-group-item list-group-item-action').text(blog.title);
                                searchResults.append(blogItem);
                            });
                        }
                    }
                },
                error: function(error) {
                    console.error('Error:', error);
                }
            });
        }, 1000); // 1000 æ¯«ç§’å»¶è¿Ÿ
    });

</script>
</body>
</html>
